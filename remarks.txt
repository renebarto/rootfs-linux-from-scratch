General:

- buildroot does not update *.pc files which may lead to issues later on. So I've add this feature.
- When updating references in *.pc and *.la files, sometimes the staging directory is present. This also needs to be replaced. I've added install-functions which does the full backward and forward replacement.
- Since buildroot commit 2d0d94ef43377c94b6c74679ed65f95bb35f7b02 (2017-10-03), wpewebkit was bumped to eafdc7f08cfc5a4a256dcff0c1881784fa4341fe, which enforces usage of libepoxy. This will fail the build if we do not have that library. For now, we are going back to commit 5811a55428f6fa7631461002c65ed48ef86f44f8 (2017-09-25) which does not need libepoxy yet. But we need to fix that.

Running Weston:
- After building, the output is in output/target. The weston executable is therefore in output/target/usr/bin. Simply starting it will not work, you will have to set some variables:
export XDG_RUNTIME_DIR=/tmp/weston or /run/user/1000
mkdir -p $XDG_RUNTIME_DIR
chmod 700 $XDG_RUNTIME_DIR
export LIBGL_DRIVERS_PATH=$BUILD_PREFIX/output/target/usr/lib/dri
If desired, update the  weston.ini file in $BUILD_PREFIX/output/target/etc/xdg
From output/target/usr/bin, run ./weston -c ../../etc/xdg/weston.ini

expat-2.2.0

-

zlib-1.2.11

- For some strange reason, some variables are placed in a different position:
ac_cv_lbl_unaligned_fail=no \
ac_cv_func_mmap_fixed_mapped=yes \
ac_cv_func_memcmp_working=yes \
ac_cv_have_decl_malloc=yes \
gl_cv_func_malloc_0_nonnull=yes \
ac_cv_func_malloc_0_nonnull=yes \
ac_cv_func_calloc_0_nonnull=yes \
ac_cv_func_realloc_0_nonnull=yes \
lt_cv_sys_lib_search_path_spec="" \
ac_cv_c_bigendian=no

libpng-1.6.28

- Although LDFLAGS_FOR_BUILD is defined correctly, libz.so cannot be found by configure Additionally specifying LDFLAGS="-L$staging_directory/usr/lib" works, but is in conflict with buildroot!
- Similarly, zlib.h is not found by build unless CPATH=$staging_directory/usr/include is specified.
- Need to also fix /usr/bin/libpng16-config and libpng-config for correct paths.

freetype-2.7.1

- Need to also fix /usr/bin/freetype-config for correct paths.

fontconfig-2.12.1

- Font cache is not generated by build, need to run fc-cache at some time

util-macros-1.19.1

- Is mention as xutil_util-macros, but build later in buildroot, but is needed for libpciaccess.

libpciaccess-0.13.4

- Although LDFLAGS_FOR_BUILD is defined correctly, libz.so cannot be found by configure Additionally specifying LDFLAGS="-L$staging_directory/usr/lib" works, but is in conflict with buildroot!
- Similarly, zlib.h is not found by build unless CPATH=$staging_directory/usr/include is specified, both for configure and make.

libpthread-stubs-0.3

-

libffi-3.2.1

- Needs auto-reconf, so added this as option to package.

ncurses-5.9

- Needed by readline. Weirdly complains about usr/lib/pkgconfig/zlib.pc not being a directory, while trying to install .pc files. However ncurses does itself not generate a .pc file.
- Need to also fix /usr/bin/ncurses5-config for correct paths.

readline-7.0

-

util-linux-2.29.2

-

libdrm-2.4.75

- Is supposed to depend on udev, but builds fine without it.

xcb-proto-1.12

- 

xproto_xproto-7.0.31

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

xlib_libXau-1.0.8

-

xlib_libXdmcp-1.1.2

-

libxcb-1.12

-

openssl-1.0.2k

-

libxml2-2.9.4

- Need to also fix /usr/bin/xml2-config for correct paths. Otherwise, libxslt-1.1.29 will fail to build.

wayland-1.13.0

- Buildroot builds a host version first to make sure wayland-scanner exists, then uses the host version to generate code. Switched to generating and using wayland-scanner on the fly.

xlib_xtrans-1.3.5

-

xproto_inputproto-2.3.2

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

xproto_kbproto-1.0.7

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

xproto_xextproto-7.3.0

- This proto IS installed to target.

xproto_xf86bigfontproto-1.2.0

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

xlib_libX11-1.6.5

-

xproto_fixesproto-5.0

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

xlib_libXfixes-5.0.3

-

xproto_damageproto-1.2.1

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

xlib_libXdamage-1.1.4

-

xlib_libXext-1.3.3

-

xproto_dri2proto-2.8

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

xproto_glproto-1.4.17

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

xproto_xf86driproto-2.1.1

- X proto packages are not installed to the target by buildroot. We still do this, just be sure, but might add an option to stop installing to the target.

mesa-17.0.1

-

gettext-0.19.8.1

- Need to also fix /usr/bin/gettextize for correct paths.

pcre-8.40

- Need to also fix /usr/bin/prce-config for correct paths.

libglib2-2.50.3

- Need to also fix /usr/bin/glib-gettextize for correct paths.

pixman-0.34.0

-

cairo-1.14.8

-

gmp-6.1.2

-

nettle-2.7.1

- Version 2.7.1 due to playready. Needs gmp-6.1.2

gnutls-3.3.22

- Needs nettle-2.7.1
- Needs to find DNSSEC root key

intltool-0.51.0

- Need to also fix /usr/bin/intltoolize for correct paths.

graphite2-1.3.9

-

gstreamer1-1.10.4

-

orc-0.4.26

-

xproto_videoproto-2.3.3

-

xlib_libXv 1.0.11

-

gst1-plugins-base-1.10.4

- Enabled audiotestsrc and videotestsrc, and audiorate and videorate.

gst1-plugins-good-1.10.4

- Enabled auto detection, however still no autoaudiosink or autovideosink present.

libglu-9.0.0

-

gst1-plugins-bad-1.10.4

- Blocks on gettextize. We need to build our own gettext package, as buildroot does. Now added.
- As gettextize is in a different directory, it is important to specify gettext_datadir=$staging_directory/usr/share/gettext when calling gettextize
- For the same reason , it is important to specify AUTOM4TE=/usr/bin/autom4te gettext_datadir=$staging_directory/usr/share/gettext when calling autoreconfigure.

mpg123-1.23.8

-

gst1-plugins-ugly-1.10.4

-

host-icu-57.1

- Due to the way icu is built, we need to perform a host build first, which is then only referenced by build directory.
- For a successful build, host-icu should not use any libraries from the staging system.

icu-57.1

- See host-icu-57.1
- Need to also fix /usr/bin/icu-config for correct paths.

harfbuzz-1.4.4

- For netflix, harfbuzz 1.0.1 is used


jpeg-turbo-1.5.1

-

# libcurl-7.53.1

libgpg-error-1.26

- Need to also fix /usr/bin/gpg-error-config for correct paths.

libgcrypt-1.7.6

- Needs libgpg-error-1.26
- Need to also fix /usr/bin/libgrypt-config for correct paths.

# xlib_libXi-1.7.9
# xlib_libXt-1.1.5
# xlib_libXmu-1.1.2
# libglew-2.0.0

libmng-2.0.3

-

sqlite-3170000

-

libsoup-2.56.0

-

# libxkbcommon-0.7.1

libxslt-1.1.29

- Needs libgcrypt-1.7.6
- Need correct path in /usr/bin/xml2-config

# linux-firmware

playready

- CMake does not contain pkgconfig files, so these are installed separately.

webp-0.5.2

- Seems to depend on libpng, however also needs libmng.

# freetype-2.7.1
# shared-mime-info-1.8
# wayland-protocols-1.7

wpebackend

- Needed to install toolchain file for cmake. Now passing STAGING_DIR to correctly find headers and libs.

wpewebkit

- According to buildroot a patch is needed for WEBPImageDecode.h/cpp, however the patch fails for the newer version of wpewebkit. It only succeeds for commit 5811a55428f6fa7631461002c65ed48ef86f44f8, not for eafdc7f08cfc5a4a256dcff0c1881784fa4341fe.
- Needs icu 57.1
- Needs gnutls-3.3.22
- New version needs libepoxy
- Needs libgcrypt-1.7.6
- Needs playready, not checked as required, dropped for now

# wpelauncher
# xkeyboard-config-2.20
# wpebackend-rdk
# xlib_libxkbfile-1.0.9
# xapp_xkbcomp-1.3.1


Weston specific

eudev-3.2.1

- Needs kmod in buildroot, switched off: --disable-kmod

mtdev-1.1.4

-

libevdev-1.5.6

-

libinput-1.6.3

- Needs libevdev-1.5.6

wayland-protocols-1.7

-

libxkbcommon-0.7.1

-

xproto_renderproto-0.11.1

-

xlib_libXrender-0.9.10

- Needs xproto_renderproto-0.11.1

xlib_libXcursor-1.1.14

- Needs xlib_libXrender-0.9.10

weston-2.0.0

- Needs xlib_libXcursor-1.1.14, mtdev-1.1.4, eudev-3.2.1, libinput-1.6.3, libxkbcommon-0.7.1, wayland-protocols-1.7
